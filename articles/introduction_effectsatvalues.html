<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction: Marginal Effects at Specific Values • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction: Marginal Effects at Specific Values">
<meta property="og:description" content="ggeffects">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggeffects</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introductions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ggeffects.html">Marginal Effects of Regression Models</a>
    </li>
    <li>
      <a href="../articles/introduction_effectsatvalues.html">Marginal Effects at Specific Values</a>
    </li>
    <li>
      <a href="../articles/introduction_randomeffects.html">Marginal Effects for Random Effects Models</a>
    </li>
    <li>
      <a href="../articles/introduction_partial_residuals.html">Adding Partial Residuals to Marginal Effects Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plotting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_plotmethod.html">Plotting Marginal Effects</a>
    </li>
    <li>
      <a href="../articles/introduction_plotcustomize.html">Customize Plot Appearance</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Practical Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/practical_logisticmixedmodel.html">Logistic Mixed Effects Model with Interaction Term</a>
    </li>
    <li>
      <a href="../articles/practical_robustestimation.html">(Cluster) Robust Standard Errors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical Details
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/technical_differencepredictemmeans.html">Difference between ggpredict() and ggemmeans()</a>
    </li>
    <li>
      <a href="../articles/technical_stata.html">Different Output between Stata and ggeffects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/strengejacke/ggeffects/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_effectsatvalues_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="introduction_effectsatvalues_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="introduction_effectsatvalues_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introduction: Marginal Effects at Specific Values</h1>
                        <h4 class="author">Daniel Lüdecke</h4>
            
            <h4 class="date">2020-11-30</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/ggeffects/blob/master/vignettes/introduction_effectsatvalues.Rmd"><code>vignettes/introduction_effectsatvalues.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_effectsatvalues.Rmd</code></div>

    </div>

    
    
<div id="marginal-effects-at-specific-values-or-levels" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-effects-at-specific-values-or-levels" class="anchor"></a>Marginal effects at specific values or levels</h1>
<p>This vignettes shows how to calculate marginal effects at specific values or levels for the terms of interest. It is recommended to read the <a href="ggeffects.html">general introduction</a> first, if you haven’t done this yet.</p>
<p>The <code>terms</code>-argument not only defines the model terms of interest, but each model term can be limited to certain values. This allows to compute and plot marginal effects for (grouping) terms at specific values only, or to define values for the main effect of interest.</p>
<p>There are several options to define these values, which always should be placed in square brackets directly after the term name and can vary for each model term.</p>
<ol style="list-style-type: decimal">
<li><p>Concrete values are separated by a comma: <code>terms = "c172code [1,3]"</code>. For factors, you could also use factor levels, e.g. <code>terms = "Species [setosa,versicolor]"</code>.</p></li>
<li><p>Ranges are specified with a colon: <code>terms = c("c12hour [30:80]", "c172code [1,3]")</code>. This would plot all values from 30 to 80 for the variable <em>c12hour</em>. By default, the step size is 1, i.e. <code>[1:4]</code> would create the range <code>1, 2, 3, 4</code>. You can choose different step sizes with <code>by</code>, e.g. <code>[1:4 by=.5]</code>.</p></li>
<li><p>Convenient shortcuts to calculate common values like mean +/- 1 SD (<code>terms = "c12hour [meansd]"</code>), quartiles (<code>terms = "c12hour [quart]"</code>) or minumum and maximum values (<code>terms = "c12hour [minmax]"</code>). See <code><a href="../reference/values_at.html">values_at()</a></code> for the different options.</p></li>
<li><p>A function name. The function is then applied to all unique values of the indicated variable, e.g. <code>terms = "hp [exp]"</code>. You can also define own functions, and pass the name of it to the <code>terms</code>-values, e.g. <code>terms = "hp [own_function]"</code>.</p></li>
<li><p>A variable name. The values of the variable are then used to define the <code>terms</code>-values, e.g. first, a vector is defined: <code>v = c(1000, 2000, 3000)</code> and then, <code>terms = "income [v]"</code>.</p></li>
<li><p>If the <em>first</em> variable specified in <code>terms</code> is a <em>numeric</em> vector, for which no specific values are given, a “pretty range” is calculated (see <code><a href="../reference/pretty_range.html">pretty_range()</a></code>), to avoid memory allocation problems for vectors with many unique values. To select all values, use the <code>[all]</code>-tag, e.g. <code>terms = "mpg [all]"</code>. If a <em>numeric</em> vector is specified as <em>second</em> or <em>third</em> variable in <code>term</code> (i.e. if this vector represents a grouping structure), representative values (see <code><a href="../reference/values_at.html">values_at()</a></code>) are chosen, which is typically mean +/- SD.</p></li>
<li><p>To create a pretty range that should be smaller or larger than the default range (i.e. if no specific values would be given), use the <code>n</code>-tag, e.g. <code>terms = "age [n=5]"</code> or <code>terms = "age [n = 12]"</code>. Larger values for <code>n</code> return a larger range of predicted values.</p></li>
<li><p>Especially useful for plotting group levels of random effects with many levels, is the <code>sample</code>-option, e.g. <code>terms = "Subject [sample=9]"</code>, which will sample nine values from all possible values of the variable <code>Subject</code>.</p></li>
</ol>
<div id="specific-values-and-value-range" class="section level2">
<h2 class="hasAnchor">
<a href="#specific-values-and-value-range" class="anchor"></a>Specific values and value range</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">neg_c_7</span> <span class="op">+</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">c172code</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span>

<span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c12hour [30:80]"</span>, <span class="st">"c172code [1,3]"</span><span class="op">)</span><span class="op">)</span>
<span class="va">mydf</span>
<span class="co">#&gt; # Predicted values of Total score BARTHEL INDEX</span>
<span class="co">#&gt; # x = average number of hours of care per week</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # c172code = low level of education</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  x | Predicted |         95% CI</span>
<span class="co">#&gt; -------------------------------</span>
<span class="co">#&gt; 30 |     67.15 | [64.04, 70.26]</span>
<span class="co">#&gt; 38 |     65.12 | [62.06, 68.18]</span>
<span class="co">#&gt; 47 |     62.84 | [59.81, 65.88]</span>
<span class="co">#&gt; 55 |     60.81 | [57.78, 63.85]</span>
<span class="co">#&gt; 63 |     58.79 | [55.72, 61.85]</span>
<span class="co">#&gt; 80 |     54.48 | [51.28, 57.68]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # c172code = high level of education</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  x | Predicted |         95% CI</span>
<span class="co">#&gt; -------------------------------</span>
<span class="co">#&gt; 30 |     68.58 | [65.42, 71.75]</span>
<span class="co">#&gt; 38 |     66.56 | [63.39, 69.73]</span>
<span class="co">#&gt; 47 |     64.28 | [61.08, 67.47]</span>
<span class="co">#&gt; 55 |     62.25 | [59.01, 65.50]</span>
<span class="co">#&gt; 63 |     60.23 | [56.91, 63.54]</span>
<span class="co">#&gt; 80 |     55.92 | [52.39, 59.45]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * neg_c_7 = 11.84</span>
<span class="co">#&gt; * c161sex =  1.76</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">mydf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">predicted</span>, colour <span class="op">=</span> <span class="va">group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-1-1.png" width="672"></p>
<p>When variables are, for instance, log-transformed, <em>ggeffects</em> automatically back-transforms predictions to the original scale of the response and predictors, making the predictions directly interpretable. However, sometimes it might be useful to define own value ranges. In such situation, specify the range in the <code>terms</code>-argument.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>
<span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>

<span class="co"># x-values and predictions based on the full range of the original "hp"-values</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;  50 |     30.53 | [27.95, 33.11]</span>
<span class="co">#&gt;  85 |     24.82 | [23.28, 26.36]</span>
<span class="co">#&gt; 120 |     21.11 | [19.96, 22.25]</span>
<span class="co">#&gt; 155 |     18.35 | [17.16, 19.54]</span>
<span class="co">#&gt; 195 |     15.88 | [14.42, 17.34]</span>
<span class="co">#&gt; 230 |     14.10 | [12.36, 15.85]</span>
<span class="co">#&gt; 265 |     12.58 | [10.56, 14.60]</span>
<span class="co">#&gt; 335 |     10.06 | [ 7.55, 12.56]</span>

<span class="co"># x-values and predictions based on "hp"-values ranging from 50 to 150</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp [50:150]"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;  50 |     30.53 | [27.95, 33.11]</span>
<span class="co">#&gt;  63 |     28.04 | [25.94, 30.14]</span>
<span class="co">#&gt;  75 |     26.17 | [24.41, 27.93]</span>
<span class="co">#&gt;  87 |     24.57 | [23.07, 26.07]</span>
<span class="co">#&gt; 100 |     23.07 | [21.77, 24.37]</span>
<span class="co">#&gt; 113 |     21.75 | [20.57, 22.94]</span>
<span class="co">#&gt; 125 |     20.67 | [19.54, 21.80]</span>
<span class="co">#&gt; 150 |     18.71 | [17.54, 19.87]</span></code></pre></div>
<p>By default, the step size for a range is 1, like <code>50, 51, 52, ...</code>. If you need a different step size, use <code>by=&lt;stepsize&gt;</code> inside the brackets, e.g. <code>"hp [50:60 by=.5]"</code>. This would create a range from 50 to 60, with .5er steps.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># range for x-values with .5-steps</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp [50:60 by=.5]"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     x | Predicted |         95% CI</span>
<span class="co">#&gt; ----------------------------------</span>
<span class="co">#&gt; 50.00 |     30.53 | [27.95, 33.11]</span>
<span class="co">#&gt; 51.50 |     30.21 | [27.69, 32.73]</span>
<span class="co">#&gt; 52.50 |     30.01 | [27.53, 32.48]</span>
<span class="co">#&gt; 53.50 |     29.80 | [27.36, 32.24]</span>
<span class="co">#&gt; 55.00 |     29.50 | [27.12, 31.88]</span>
<span class="co">#&gt; 56.50 |     29.22 | [26.89, 31.54]</span>
<span class="co">#&gt; 57.50 |     29.03 | [26.74, 31.31]</span>
<span class="co">#&gt; 60.00 |     28.57 | [26.37, 30.77]</span></code></pre></div>
</div>
<div id="choosing-representative-values" class="section level2">
<h2 class="hasAnchor">
<a href="#choosing-representative-values" class="anchor"></a>Choosing representative values</h2>
<p>Especially in situations where we have two continuous variables in interaction terms, or where the “grouping” variable is continuous, it is helpful to select representative values of the grouping variable - else, predictions would be made for too many groups, which is no longer helpful when interpreting marginal effects.</p>
<p>You can use</p>
<ul>
<li>
<code>"minmax"</code>: minimum and maximum values (lower and upper bounds) of the variable are used.</li>
<li>
<code>"meansd"</code>: uses the mean value as well as one standard deviation below and above mean value.</li>
<li>
<code>"zeromax"</code>: is similar to the <code>"minmax"</code> option, however, 0 is always used as minimum value. This may be useful for predictors that don’t have an empirical zero-value.</li>
<li>
<code>"quart"</code> calculates and uses the quartiles (lower, median and upper), <em>including</em> minimum and maximum value.</li>
<li>
<code>"quart2"</code> calculates and uses the quartiles (lower, median and upper), <em>excluding</em> minimum and maximum value.</li>
<li>
<code>"all"</code> takes all values of the vector.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span>
<span class="co"># short variable label, for plot</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c12hour</span>, <span class="st">"label"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hours of care"</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">*</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="va">neg_c_7</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span>

<span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c161sex"</span>, <span class="st">"c12hour [meansd]"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">mydf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">fit</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c161sex"</span>, <span class="st">"c12hour [quart]"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">mydf</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-4-2.png" width="672"></p>
</div>
<div id="transforming-values-with-functions" class="section level2">
<h2 class="hasAnchor">
<a href="#transforming-values-with-functions" class="anchor"></a>Transforming values with functions</h2>
<p>The brackets in the <code>terms</code>-argument also accept the name of a valid function, to (back-)transform predicted values. In this example, we define a custom function to get the original values of the focal predictor, multiplied by 2.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># x-values and predictions based on "hp"-values, multiplied by 2</span>
<span class="va">hp_double</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">x</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp [hp_double]"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt; 104 |     22.65 | [21.39, 23.91]</span>
<span class="co">#&gt; 132 |     20.08 | [18.96, 21.20]</span>
<span class="co">#&gt; 186 |     16.39 | [15.00, 17.78]</span>
<span class="co">#&gt; 210 |     15.08 | [13.50, 16.67]</span>
<span class="co">#&gt; 226 |     14.29 | [12.58, 16.00]</span>
<span class="co">#&gt; 300 |     11.24 | [ 8.97, 13.51]</span>
<span class="co">#&gt; 410 |      7.88 | [ 4.94, 10.83]</span>
<span class="co">#&gt; 670 |      2.59 | [-1.46,  6.65]</span></code></pre></div>
</div>
<div id="using-values-from-a-variable-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#using-values-from-a-variable-vector" class="anchor"></a>Using values from a variable (vector)</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">200</span>, <span class="fl">300</span><span class="op">)</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp [val]"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt; 100 |     23.07 | [21.77, 24.37]</span>
<span class="co">#&gt; 200 |     15.61 | [14.11, 17.11]</span>
<span class="co">#&gt; 300 |     11.24 | [ 8.97, 13.51]</span></code></pre></div>
</div>
<div id="pretty-value-ranges" class="section level2">
<h2 class="hasAnchor">
<a href="#pretty-value-ranges" class="anchor"></a>Pretty value ranges</h2>
<p>This section is intended to show some examples how the plotted output differs, depending on which value range is used. Some transformations, like polynomial or spline terms, but also quadratic or cubic terms, result in many predicted values. In such situation, predictions for some models lead to memory allocation problems. That is why <code><a href="../reference/ggeffect.html">ggpredict()</a></code> “prettifies” certain value ranges by default, at least for some model types (like mixed models).</p>
<p>To see the difference in the “curvilinear” trend, we use a quadratic term on a standardized variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjmisc">sjmisc</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjlabelled/">sjlabelled</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span>

<span class="va">efc</span><span class="op">$</span><span class="va">c12hour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/sjmisc/reference/std.html">std</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">c12hour</span><span class="op">)</span>
<span class="va">efc</span><span class="op">$</span><span class="va">e15relat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/as_label.html">as_label</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">e15relat</span><span class="op">)</span>

<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span>
  <span class="va">barthtot</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">c12hour</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">neg_c_7</span> <span class="op">+</span> <span class="va">c160age</span> <span class="op">+</span> <span class="va">c172code</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">e15relat</span><span class="op">)</span>, 
  data <span class="op">=</span> <span class="va">efc</span>
<span class="op">)</span>

<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div id="turn-off-prettifying" class="section level3">
<h3 class="hasAnchor">
<a href="#turn-off-prettifying" class="anchor"></a>Turn off “prettifying”</h3>
<p>As said above, <code><a href="../reference/ggeffect.html">ggpredict()</a></code> “prettifies” the vector, resulting in a smaller set of unique values. This is less memory consuming and may be needed especially for more complex models.</p>
<p>You can turn off automatic “prettifying” by adding the <code>"all"</code>-shortcut to the <code>terms</code>-argument.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour [all]"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>This results in a smooth plot, as all values from the term of interest are taken into account.</p>
</div>
<div id="using-different-ranges-for-prettifying" class="section level3">
<h3 class="hasAnchor">
<a href="#using-different-ranges-for-prettifying" class="anchor"></a>Using different ranges for prettifying</h3>
<p>To modify the “prettifying”, add the <code>"n"</code>-shortcut to the <code>terms</code>-argument. This allows you to select a feasible range of values that is smaller (and hence less memory consuming) them <code>"terms = ... [all]"</code>, but still produces smoother plots than the default prettyfing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour [n=2]"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-9-1.png" width="672"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour [n=10]"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
</div>
<div id="marginal-effects-conditioned-on-specific-values-of-the-covariates" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-effects-conditioned-on-specific-values-of-the-covariates" class="anchor"></a>Marginal effects conditioned on specific values of the covariates</h2>
<p>By default, the <code>typical</code>-argument determines the function that will be applied to the covariates to hold these terms at constant values. By default, this is the mean-value, but other options (like median or mode) are possible as well.</p>
<p>Use the <code>condition</code>-argument to define other values at which covariates should be held constant. <code>condition</code> requires a named vector, with the name indicating the covariate.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>
<span class="va">mpg_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">mpg</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">hp</span><span class="op">)</span> <span class="op">+</span> <span class="va">disp</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>

<span class="co"># "disp" is hold constant at its mean</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;  50 |     25.84 | [22.03, 29.66]</span>
<span class="co">#&gt;  85 |     22.70 | [20.75, 24.64]</span>
<span class="co">#&gt; 120 |     20.65 | [19.59, 21.71]</span>
<span class="co">#&gt; 155 |     19.13 | [17.96, 20.30]</span>
<span class="co">#&gt; 195 |     17.77 | [15.98, 19.56]</span>
<span class="co">#&gt; 230 |     16.79 | [14.46, 19.13]</span>
<span class="co">#&gt; 265 |     15.95 | [13.12, 18.78]</span>
<span class="co">#&gt; 335 |     14.56 | [10.89, 18.24]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * disp = 230.72</span>

<span class="co"># "disp" is hold constant at value 200</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">mpg_model</span>, <span class="st">"hp"</span>, condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>disp <span class="op">=</span> <span class="fl">200</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of mpg</span>
<span class="co">#&gt; # x = hp</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   x | Predicted |         95% CI</span>
<span class="co">#&gt; --------------------------------</span>
<span class="co">#&gt;  50 |     26.53 | [23.06, 30.00]</span>
<span class="co">#&gt;  85 |     23.38 | [21.73, 25.04]</span>
<span class="co">#&gt; 120 |     21.34 | [20.31, 22.37]</span>
<span class="co">#&gt; 155 |     19.82 | [18.40, 21.24]</span>
<span class="co">#&gt; 195 |     18.46 | [16.34, 20.58]</span>
<span class="co">#&gt; 230 |     17.48 | [14.79, 20.17]</span>
<span class="co">#&gt; 265 |     16.64 | [13.45, 19.83]</span>
<span class="co">#&gt; 335 |     15.25 | [11.21, 19.29]</span></code></pre></div>
</div>
<div id="marginal-effects-for-each-level-of-random-effects" class="section level2">
<h2 class="hasAnchor">
<a href="#marginal-effects-for-each-level-of-random-effects" class="anchor"></a>Marginal effects for each level of random effects</h2>
<p>Marginal effects can also be calculated for each group level in mixed models. Simply add the name of the related random effects term to the <code>terms</code>-argument, and set <code>type = "re"</code>.</p>
<p>In the following example, we fit a linear mixed model and first simply plot the marginal effetcs, <em>not</em> conditioned on random effects.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/sjlabelled/">sjlabelled</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/">lme4</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">efc</span><span class="op">)</span>
<span class="va">efc</span><span class="op">$</span><span class="va">e15relat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://strengejacke.github.io/sjlabelled/reference/as_label.html">as_label</a></span><span class="op">(</span><span class="va">efc</span><span class="op">$</span><span class="va">e15relat</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">neg_c_7</span> <span class="op">~</span> <span class="va">c12hour</span> <span class="op">+</span> <span class="va">c160age</span> <span class="op">+</span> <span class="va">c161sex</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">e15relat</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">efc</span><span class="op">)</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>Changing the type to <code>type = "re"</code> still returns population-level predictions by default. The major difference between <code>type = "fe"</code> and <code>type = "re"</code> is the uncertainty in the variance parameters. This leads to larger confidence intervals for marginal effects with <code>type = "re"</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="st">"c12hour"</span>, type <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>To compute marginal effects for each grouping level, add the related random term to the <code>terms</code>-argument. In this case, confidence intervals are not calculated, but marginal effects are conditioned on each group level of the random effects.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"e15relat"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-14-1.png" width="672"></p>
<p>Marginal effects, conditioned on random effects, can also be calculated for specific levels only. Add the related values into brackets after the variable name in the <code>terms</code>-argument.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c12hour"</span>, <span class="st">"e15relat [child,sibling]"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<p>If the group factor has too many levels, you can also take a random sample of all possible levels and plot the marginal effects for this subsample of group levels. To do this, use <code>term = "&lt;groupfactor&gt; [sample=n]"</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sleepstudy"</span><span class="op">)</span>
<span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span><span class="op">(</span><span class="va">Reaction</span> <span class="op">~</span> <span class="va">Days</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">Days</span> <span class="op">|</span> <span class="va">Subject</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sleepstudy</span><span class="op">)</span>
<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">m</span>, terms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Days"</span>, <span class="st">"Subject [sample=8]"</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"re"</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="va">me</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_effectsatvalues_files/figure-html/unnamed-chunk-16-1.png" width="672"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/strengejacke">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
