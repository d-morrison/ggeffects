<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intoduction to Adjusted Predictions and Marginal Effects in R • ggeffects</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intoduction to Adjusted Predictions and Marginal Effects in R">
<meta property="og:description" content="ggeffects">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggeffects</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Introductions
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ggeffects.html">Marginal Effects of Regression Models</a>
    </li>
    <li>
      <a href="../articles/introduction_marginal_effects.html">Definition of Marginal Effects</a>
    </li>
    <li>
      <a href="../articles/introduction_effectsatvalues.html">Marginal Effects at Specific Values</a>
    </li>
    <li>
      <a href="../articles/introduction_randomeffects.html">Marginal Effects for Random Effects Models</a>
    </li>
    <li>
      <a href="../articles/introduction_partial_residuals.html">Adding Partial Residuals to Marginal Effects Plots</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Plotting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/introduction_plotmethod.html">Plotting Marginal Effects</a>
    </li>
    <li>
      <a href="../articles/introduction_plotcustomize.html">Customize Plot Appearance</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Practical Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/practical_logisticmixedmodel.html">Logistic Mixed Effects Model with Interaction Term</a>
    </li>
    <li>
      <a href="../articles/practical_robustestimation.html">(Cluster) Robust Standard Errors</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Technical Details
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/technical_differencepredictemmeans.html">Difference between ggpredict() and ggemmeans()</a>
    </li>
    <li>
      <a href="../articles/technical_stata.html">Different Output between Stata and ggeffects</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/strengejacke/ggeffects/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_marginal_effects_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Intoduction to Adjusted Predictions and Marginal Effects in R</h1>
                        <h4 class="author">Daniel Lüdecke</h4>
            
            <h4 class="date">2021-04-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/strengejacke/ggeffects/blob/master/vignettes/introduction_marginal_effects.Rmd"><code>vignettes/introduction_marginal_effects.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_marginal_effects.Rmd</code></div>

    </div>

    
    
<div id="marginal-effects-and-predictions" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-effects-and-predictions" class="anchor"></a>Marginal effects and predictions</h1>
<p>There is no common language across fields regarding a unique meaning of “marginal effects”. Thus, the wording throughout this package may vary. The most generic description of what <em>ggeffects</em> does, is: <em>ggeffects</em> allows us to interpret a statistical model by making predictions generated by the model when one holds the non-focal variables constant and varies the focal variable(s).</p>
<p>In the following, some examples are shown to make clear what is actually calculated and returned by the package’s functions <code><a href="../reference/ggeffect.html">ggpredict()</a></code>, <code><a href="../reference/ggeffect.html">ggemmeans()</a></code> and <code><a href="../reference/ggeffect.html">ggeffect()</a></code>, and how this differs from other functions or software packages that calculate marginal effects.</p>
<div id="an-example-with-a-simple-linear-model" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example-with-a-simple-linear-model" class="anchor"></a>An example with a simple linear model</h2>
<p>First, we fit s simple linear model and look at the coefficient of the only predictor, <code>Sepal.Width</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span>
<span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Sepal.Length</span> <span class="op">~</span> <span class="va">Sepal.Width</span>, data <span class="op">=</span> <span class="va">iris</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">[</span><span class="st">"Sepal.Width"</span><span class="op">]</span>
<span class="co">#&gt; Sepal.Width </span>
<span class="co">#&gt;  -0.2233611</span></code></pre></div>
<p>In this basic example, the coefficient we see here is the <em>slope</em> of the regression line:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Sepal.Width</span>, y <span class="op">=</span> <span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">[</span><span class="st">"(Intercept)"</span><span class="op">]</span>, 
              slope <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">[</span><span class="st">"Sepal.Width"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_marginal_effects_files/figure-html/unnamed-chunk-2-1.png" width="672"></p>
<p>For this simple linear model, the slope for the regression line is always the same for each value of our predictor, <code>Sepal.Width</code>. We can check this by generating predictions of our model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://strengejacke.github.io/ggeffects/">ggeffects</a></span><span class="op">)</span>
<span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"Sepal.Width"</span><span class="op">)</span>
<span class="va">pr</span>
<span class="co">#&gt; # Predicted values of Sepal.Length</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Sepal.Width | Predicted |       95% CI</span>
<span class="co">#&gt; --------------------------------------</span>
<span class="co">#&gt;        2.00 |      6.08 | [5.73, 6.43]</span>
<span class="co">#&gt;        2.20 |      6.03 | [5.74, 6.33]</span>
<span class="co">#&gt;        2.60 |      5.95 | [5.75, 6.14]</span>
<span class="co">#&gt;        3.00 |      5.86 | [5.72, 5.99]</span>
<span class="co">#&gt;        3.20 |      5.81 | [5.67, 5.95]</span>
<span class="co">#&gt;        3.40 |      5.77 | [5.60, 5.93]</span>
<span class="co">#&gt;        3.80 |      5.68 | [5.42, 5.94]</span>
<span class="co">#&gt;        4.40 |      5.54 | [5.11, 5.97]</span></code></pre></div>
<p>“Predictions” returned by <em>ggeffects</em> are essentially interpretations of regression coefficients in terms of <em>comparison</em>. We can compare how much our outcome (<code>Sepal.Length</code>) changes on average, when the focal term (in this case: <code>Sepal.Width</code>) varies: For example, what is the average value of <code>Sepal.Length</code> for observations with a value of, say, <code>2</code> for <code>Sepal.Width</code>, compared to observations with a <code>3</code> for <code>Sepal.Width</code>?</p>
<p><em>ggeffects</em> returns predictions for <a href="https://strengejacke.github.io/ggeffects/articles/introduction_effectsatvalues.html">representative values</a> of the focal term(s), hence you see many predicted values (including confidence intervals) in the output for the different values of the focal term(s).</p>
<p>If we now look at the differences between any two predicted values, we see that these are identical:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Difference between predicted values for Sepal.Width = 2 and 3</span>
<span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"Sepal.Width [2,3]"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">pr</span><span class="op">$</span><span class="va">predicted</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; [1] -0.2234</span>

<span class="co"># Difference between predicted values for Sepal.Width = 3 and 4</span>
<span class="va">pr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model1</span>, <span class="st">"Sepal.Width [4,5]"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">pr</span><span class="op">$</span><span class="va">predicted</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; [1] -0.2234</span></code></pre></div>
<p>Furthermore, the difference of predicted values that differ by <code>1</code> in the focal term (<code>Sepal.Width</code>), equals the regression coefficient. This is because the interpretation of a regression coefficient can be seen as average difference in the outcome, “comparing two individuals that differ in one predictor [a difference of <code>1</code> for <code>Sepal.Width</code> in this case], while being at the same levels of all other predictors.” (Gelman, Hill, Vehtari 2020, page 494). We don’t have any other predictors in this example, so we don’t go into deeper details here.</p>
<p>Thus, the association - or <em>effect</em> - between <code>Sepal.Length</code> and <code>Sepal.Width</code> is the same for every value of <code>Sepal.Width</code>. This means, that for simple linear models, the regression coefficient is also the <em>marginal effect</em>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/leeper/margins">margins</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/margins/man/margins.html">margins</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span>
<span class="co">#&gt;  Sepal.Width</span>
<span class="co">#&gt;      -0.2234</span></code></pre></div>
<p>The <em>marginal effect</em> here is at the same time the <em>average marginal effect</em>, because on average, the effect of <code>Sepal.Width</code> on <code>Sepal.Length</code> is -0.2234: when <code>Sepal.Width</code> changes by <code>1</code>, the value of <code>Sepal.Length</code> changes by -0.2234 on average.</p>
</div>
<div id="an-example-with-a-simple-logistic-regression-model" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example-with-a-simple-logistic-regression-model" class="anchor"></a>An example with a simple logistic regression model</h2>
<p>For the next example, we simulate some data for a logistic regression model.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.7</span><span class="op">)</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">y_1</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">==</span> <span class="fl">1</span>
<span class="va">x</span><span class="op">[</span><span class="va">y_1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">y_1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y_1</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>
<span class="va">model2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span><span class="op">[</span><span class="st">"x"</span><span class="op">]</span>
<span class="co">#&gt;        x </span>
<span class="co">#&gt; 2.640768</span></code></pre></div>
<p>The regression coefficient for <code>x</code> (on the logit-scale) is 2.6408. However, for a logistic regression, this “slope” is not constant across all values of <code>x</code>, because we have non-linear transformations here. We can make this more clear by looking at the predicted probabilities:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot.html">plot</a></span><span class="op">(</span><span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="st">"x [all]"</span><span class="op">)</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, add.data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="introduction_marginal_effects_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<p>As we can see, we have some differences in the case of logistic regression models compared to the linear regression model:</p>
<ol style="list-style-type: decimal">
<li><p>We no longer have the predicted <em>average difference</em> or <em>mean</em> in our outcome, but rather the predicted <em>probability</em> that our outcome is <code>1</code> for a given value of <code>x</code>.</p></li>
<li><p>Due to the non-linear transformation, the slope differs at different values for <code>x</code>, thus, the “marginal effect” or “association” (in terms of probabilities) is not constant across values of <code>x</code>.</p></li>
<li><p>While the regression coefficient in linear models is already on the response scale, and hence the (average) marginal effect equals the regression coefficient, we have different scales in logistic regression models: the coefficients shown in <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> are on the logit-scale (the scale of the linear predictor); exponentiating that coefficient (i.e. <code><a href="https://rdrr.io/r/base/Log.html">exp(coef(model2))</a></code>) returns an <em>odds ratio</em>; predictions are easy to interpret in terms of <em>probabilities</em>, as mentioned under 1).</p></li>
</ol>
<p>First, let’s look at the average marginal effect of <code>x</code> in this model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/margins/man/margins.html">margins</a></span><span class="op">(</span><span class="va">model2</span><span class="op">)</span>
<span class="co">#&gt;      x</span>
<span class="co">#&gt;  0.154</span></code></pre></div>
<p>The result indicates “the contribution of each variable on the outcome scale”, i.e. the “change in the predicted probability that the outcome equals 1” (see vignettes from the <a href="https://cran.r-project.org/package=margins"><em>margins</em> package</a>). <em>On average</em>, a unit-change in <code>x</code> changes the predicted probability that the outcome equals 1 by 15.40%.</p>
<p>More general speaking: The marginal effect represents the difference of (two) predictions for an (infinitesimal) change in <code>x</code> (the focal term). The <em>average</em> marginal effect represents the <em>average slope</em> of that predictor.</p>
<p>I personally find it less intuitive to interpret <em>average marginal effects</em>, in particular for non-Gaussian models, because it is harder to understand an average effect where we actually have varying effects across the range of the focal term. Instead, I rather prefer to look at predictions at different values of the focal term(s), which is what <em>ggeffects</em> returns by default:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model2</span>, <span class="st">"x"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted probabilities of y</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  x | Predicted |       95% CI</span>
<span class="co">#&gt; -----------------------------</span>
<span class="co">#&gt; -2 |      0.00 | [0.00, 0.00]</span>
<span class="co">#&gt;  0 |      0.00 | [0.00, 0.00]</span>
<span class="co">#&gt;  2 |      0.03 | [0.01, 0.07]</span>
<span class="co">#&gt;  4 |      0.84 | [0.73, 0.91]</span>
<span class="co">#&gt;  6 |      1.00 | [0.99, 1.00]</span>
<span class="co">#&gt;  8 |      1.00 | [1.00, 1.00]</span>
<span class="co">#&gt; 10 |      1.00 | [1.00, 1.00]</span></code></pre></div>
<p>For <code>x = -2</code>, the predicted probability that <code>y = 1</code>, as estimated by our model, is zero. For <code>x = 10</code>, the probability is 100%. In essence, what <code><a href="../reference/ggeffect.html">ggpredict()</a></code> returns, are not <em>average</em> marginal effects, but rather the predicted values at different values of <code>x</code>. This makes clear that marginal effects require predictions: The marginal effect would be the difference between any two adjacent predicted values (if these are close enough in case of non-linear relationship between our outcome and the focal variable).</p>
</div>
</div>
<div id="marginal-effects-average-marginal-effects-or-predictions" class="section level1">
<h1 class="hasAnchor">
<a href="#marginal-effects-average-marginal-effects-or-predictions" class="anchor"></a>Marginal effects, average marginal effects or predictions?</h1>
<p>Following <a href="https://clas.ucdenver.edu/marcelo-perraillon/code-and-topics/marginal-effects">these lecture-notes</a>, marginal effects are based on predictions. The main difference is how “effects” is understood. In particular in econometrics, “marginal effects” are understood as predictions for numerical derivates of the focal term, which is achieved by Stata’s <code>margins, dydx(varname)</code> or R’s <code><a href="https://rdrr.io/pkg/margins/man/dydx.html">margins::dydx()</a></code>. However, marginal effects <em>at specific values</em>, in Stata <code>margins, at(var1 = 5, var2 = 10)</code>, are considered as <em>predictions</em> - and these kind of “marginal effects” (or: predictive margins in Stata language) is what <em>ggeffects</em> returns.</p>
<p>Thus, the language used throughout this package considers <em>marginal effects</em> as predictions, i.e. predicted values. Depending on the response scale, these are either predicted (mean) values, predicted probabilities, predicted (mean) count (for count models) etc. Currently, <em>ggeffects</em> does <em>not</em> calculate <em>average</em> marginal effects.</p>
<div id="estimated-marginal-means" class="section level2">
<h2 class="hasAnchor">
<a href="#estimated-marginal-means" class="anchor"></a>Estimated marginal means</h2>
<p>Sometimes, the term <em>estimated marginal means</em> is used as well, because this is commonly used in software packages likes SPSS, but there is also a prominent R package, <a href="https://cran.r-project.org/package=emmeans"><em>emmeans</em></a>.</p>
<p>But what is the difference, for instance, between simple means and “estimated marginal” means? And why “marginal”? The idea behind marginal effects, and estimated marginal means, is that the estimated (or predicted) average outcome value is adjusted for the remaining co-variates. We shall demonstrate this with another linear model.</p>
<p>We first simulate some fake data, where we want to see how income affects wellbeing. The dataset also includes a variable on health, which we will use later.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>
<span class="va">wellbeing</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">300</span><span class="op">)</span>
<span class="va">health</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">30</span>, <span class="fl">80</span><span class="op">)</span>
<span class="va">health</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">health</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span>, <span class="fl">30</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>

<span class="va">income</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">25</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">25</span><span class="op">)</span>, 
                    replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.2</span>, <span class="fl">.1</span><span class="op">)</span><span class="op">)</span>
<span class="va">income</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">25</span> <span class="op">&amp;</span> <span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">50</span><span class="op">)</span>, 
                              replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.3</span>, <span class="fl">.2</span><span class="op">)</span><span class="op">)</span>
<span class="va">income</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">75</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">50</span> <span class="op">&amp;</span> <span class="va">wellbeing</span> <span class="op">&lt;</span> <span class="fl">75</span><span class="op">)</span>, 
                              replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.35</span>, <span class="fl">.35</span>, <span class="fl">.3</span><span class="op">)</span><span class="op">)</span>
<span class="va">income</span><span class="op">[</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">75</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">&gt;=</span> <span class="fl">75</span><span class="op">)</span>, 
                     replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.7</span><span class="op">)</span><span class="op">)</span>

<span class="va">income</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span><span class="op">(</span><span class="va">income</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"low"</span>, <span class="st">"middle"</span>, <span class="st">"high"</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">income</span>, <span class="va">wellbeing</span>, <span class="va">health</span><span class="op">)</span></code></pre></div>
<p>We now fit a linear model, to look at the regression coefficients:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://easystats.github.io/parameters/">parameters</a></span><span class="op">)</span>
<span class="va">model3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">~</span> <span class="va">income</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>

<span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">model_parameters</a></span><span class="op">(</span><span class="va">model3</span><span class="op">)</span>
<span class="co">#&gt; Parameter       | Coefficient |   SE |         95% CI | t(297) |      p</span>
<span class="co">#&gt; -----------------------------------------------------------------------</span>
<span class="co">#&gt; (Intercept)     |       35.45 | 2.16 | [31.20, 39.70] |  16.42 | &lt; .001</span>
<span class="co">#&gt; income [middle] |       15.50 | 3.50 | [ 8.61, 22.38] |   4.43 | &lt; .001</span>
<span class="co">#&gt; income [high]   |       33.11 | 3.30 | [26.61, 39.60] |  10.03 | &lt; .001</span></code></pre></div>
<p>We can see that the average wellbeing is 15.5 points higher for people from middle incom groups compared to those from lower income groups. People with higher income even have on average a 33.11 points higher wellbeing than people with lower income.</p>
<p>We can fairly easy calculate the predicted average wellbeing by summing up the intercept and the coefficient for each middle and high income. This is what <code><a href="../reference/ggeffect.html">ggpredict()</a></code> (or <code><a href="../reference/ggeffect.html">ggemmeans()</a></code> or <code><a href="../reference/ggeffect.html">ggeffect()</a></code>) also does:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model3</span>, <span class="st">"income"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of wellbeing</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; income | Predicted |         95% CI</span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt; low    |     35.45 | [31.22, 39.68]</span>
<span class="co">#&gt; middle |     50.95 | [45.55, 56.34]</span>
<span class="co">#&gt; high   |     68.55 | [63.66, 73.45]</span></code></pre></div>
<p>In this example, the “marginal effects” (or estimated marginal means) equal the simple average values of wellbeing by the different income groups:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html">aggregate</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">wellbeing</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">d</span><span class="op">$</span><span class="va">income</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span>
<span class="co">#&gt;   Group.1        x</span>
<span class="co">#&gt; 1     low 35.44815</span>
<span class="co">#&gt; 2  middle 50.94551</span>
<span class="co">#&gt; 3    high 68.55464</span></code></pre></div>
<p>However, we may conclude that the wellbeing is not only depending on income, but also on other factors, such as health status. <code>health</code> would be a confounder that impacts the association between <code>income</code> and <code>wellbeing</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">wellbeing</span> <span class="op">~</span> <span class="va">income</span> <span class="op">+</span> <span class="va">health</span>, data <span class="op">=</span> <span class="va">d</span><span class="op">)</span>
<span class="fu"><a href="https://easystats.github.io/parameters/reference/compare_parameters.html">compare_parameters</a></span><span class="op">(</span><span class="va">model3</span>, <span class="va">model4</span><span class="op">)</span>
<span class="co">#&gt; Parameter       |               model3 |               model4</span>
<span class="co">#&gt; -------------------------------------------------------------</span>
<span class="co">#&gt; (Intercept)     | 35.45 (31.20, 39.70) | 16.37 (11.08, 21.65)</span>
<span class="co">#&gt; income (middle) | 15.50 ( 8.61, 22.38) | 11.41 ( 5.38, 17.45)</span>
<span class="co">#&gt; income (high)   | 33.11 (26.61, 39.60) | 24.44 (18.54, 30.33)</span>
<span class="co">#&gt; health          |                      |  0.58 ( 0.46,  0.69)</span>
<span class="co">#&gt; -------------------------------------------------------------</span>
<span class="co">#&gt; Observations    |                  300 |                  300</span></code></pre></div>
<p>Now we see that the effect of income on wellbeing is less pronounced when we take the health status into account. This “adjustment” for confounding variables can be accounted for when calculating marginal effects (or estimated marginal means). These predicted average values for <code>wellbeing</code> are now no longer the same as the simple group means, due to the adjustment:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model4</span>, <span class="st">"income"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted values of wellbeing</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; income | Predicted |         95% CI</span>
<span class="co">#&gt; -----------------------------------</span>
<span class="co">#&gt; low    |     39.26 | [35.51, 43.00]</span>
<span class="co">#&gt; middle |     50.67 | [45.98, 55.35]</span>
<span class="co">#&gt; high   |     63.69 | [59.34, 68.05]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * health = 39.52</span></code></pre></div>
<p>This is the difference between simple “means” and “estimated marginal means”. The latter are “adjusted” means, based on the model that adjusts for confounders. Thus, these predicted means are “marginalized” (i.e. averaged) over the levels of all covariates. This is what is meant by the sentence in the first paragraph, that <em>ggeffects</em> is “making predictions generated by the model when one <em>holds the non-focal variables constant</em>”. However, there are different way how to hold non-focal terms constant, and this is how <code><a href="../reference/ggeffect.html">ggpredict()</a></code> differs from <code><a href="../reference/ggeffect.html">ggemmeans()</a></code> and <code><a href="../reference/ggeffect.html">ggeffect()</a></code> (described in detail in <a href="https://strengejacke.github.io/ggeffects/articles/technical_differencepredictemmeans.html">this vignette</a>).</p>
</div>
<div id="an-example-with-logistic-regression" class="section level2">
<h2 class="hasAnchor">
<a href="#an-example-with-logistic-regression" class="anchor"></a>An example with logistic regression</h2>
<p>We can demonstrate the same aspect of “adjusted predictions” we have seen above for linear model, for logistic regression models. Therefore, we generate some fake data again.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>,
                 <span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span>, <span class="st">"male"</span>, <span class="st">"female"</span>,
                 <span class="st">"female"</span><span class="op">)</span>, 
               levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span>,
  smoking <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>, <span class="st">"yes"</span>,
                     <span class="st">"yes"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span>, 
                   levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no"</span>, <span class="st">"yes"</span><span class="op">)</span><span class="op">)</span>,
  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">45</span>, <span class="fl">50</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">55</span>, <span class="fl">60</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">50</span>, <span class="fl">40</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Looking at the proportions of the table, we see that many more female persons are smoking compared to male persons:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">100</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/proportions.html">proportions</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">$</span><span class="va">sex</span>, <span class="va">smoking</span><span class="op">$</span><span class="va">smoking</span><span class="op">)</span>, margin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt;         </span>
<span class="co">#&gt;          no yes</span>
<span class="co">#&gt;   male   80  20</span>
<span class="co">#&gt;   female 25  75</span></code></pre></div>
<p>In this case, we have no “estimated” or “predicted” means or averages, but predicted <em>probabilities</em>. According to the table, the probability of being female and smoking is 75%, while it’s only 20% for male persons. We get the same values for the predicted probabilities, if we run a logistic regression model:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">smoking</span> <span class="op">~</span> <span class="va">sex</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">smoking</span><span class="op">)</span>

<span class="co"># Looking at the odds ratio for "sex"</span>
<span class="fu"><a href="https://easystats.github.io/parameters/reference/model_parameters.html">model_parameters</a></span><span class="op">(</span><span class="va">model5</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Parameter    | Odds Ratio |    SE |         95% CI |     z |     p</span>
<span class="co">#&gt; ------------------------------------------------------------------</span>
<span class="co">#&gt; (Intercept)  |       0.25 |  0.28 | [0.01,   1.69] | -1.24 | 0.215</span>
<span class="co">#&gt; sex [female] |      12.00 | 16.61 | [1.03, 333.21] |  1.79 | 0.073</span>

<span class="co"># Looking at the predicted probabilities for "sex"</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model5</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted probabilities of smoking</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; sex    | Predicted |       95% CI</span>
<span class="co">#&gt; ---------------------------------</span>
<span class="co">#&gt; male   |      0.20 | [0.03, 0.69]</span>
<span class="co">#&gt; female |      0.75 | [0.38, 0.94]</span></code></pre></div>
<p>The reference category for <code>sex</code> is <em>male</em>, so we can estimate the average marginal effects for female persons using <code><a href="https://rdrr.io/pkg/margins/man/margins.html">margins()</a></code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/margins/man/margins.html">margins</a></span><span class="op">(</span><span class="va">model5</span><span class="op">)</span>
<span class="co">#&gt;  sexfemale</span>
<span class="co">#&gt;       0.55</span></code></pre></div>
<p>The interpretation is like stated above: the change in the predicted probability that the outcome equals 1 for female persons is 0.55, i.e. 55%. This is exactly the difference between the predicted probabilities for male and female persons.</p>
<p>Looking at the age distribution in the sample, we might conclude that our model produces biased estimates, and therefor biased predictions. Remember the high odds ratio of our model, as shown above. Now we include <code>age</code> as possible confounder in our model.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">smoking</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">age</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">binomial</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">smoking</span><span class="op">)</span>

<span class="co"># Looking at the odds ratio for "sex"</span>
<span class="fu"><a href="https://easystats.github.io/parameters/reference/compare_parameters.html">compare_parameters</a></span><span class="op">(</span><span class="va">model5</span>, <span class="va">model6</span>, exponentiate <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Parameter    |               model5 |                  model6</span>
<span class="co">#&gt; -------------------------------------------------------------</span>
<span class="co">#&gt; (Intercept)  |  0.25 (0.03,   2.24) | 5.52e-03 (0.00,   2.98)</span>
<span class="co">#&gt; sex (female) | 12.00 (0.80, 180.97) |     0.36 (0.00, 116.05)</span>
<span class="co">#&gt; age          |                      |     1.18 (0.97,   1.45)</span>
<span class="co">#&gt; -------------------------------------------------------------</span>
<span class="co">#&gt; Observations |                   13 |                      13</span>

<span class="co"># Looking at the predicted probabilities for "sex"</span>
<span class="fu"><a href="../reference/ggeffect.html">ggpredict</a></span><span class="op">(</span><span class="va">model6</span>, <span class="st">"sex"</span><span class="op">)</span>
<span class="co">#&gt; # Predicted probabilities of smoking</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; sex    | Predicted |       95% CI</span>
<span class="co">#&gt; ---------------------------------</span>
<span class="co">#&gt; male   |      0.65 | [0.03, 0.99]</span>
<span class="co">#&gt; female |      0.39 | [0.03, 0.94]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjusted for:</span>
<span class="co">#&gt; * age = 34.23</span></code></pre></div>
<p>As we can see, the female persons were much older than the male persons. Smoking is also associated with age and it is less likely that people smoke when they are children or younger teenagers. Adjusting for age reveals that the probability of smoking is actually higher for <em>male</em> persons, not female.</p>
</div>
</div>
<div id="conclusion-marginal-effects-conditional-effects-predictions" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusion-marginal-effects-conditional-effects-predictions" class="anchor"></a>Conclusion: Marginal effects, conditional effects, predictions…</h1>
<p><code><a href="../reference/ggeffect.html">ggpredict()</a></code> holds non-focal terms constant at their mean value (if these are continuous) or at their reference level (for factors). Thus, effects returned by <code><a href="../reference/ggeffect.html">ggpredict()</a></code> are actually <em>conditional effects</em> (i.e. these are conditioned on certain (reference) levels of factors). However, <code><a href="../reference/ggeffect.html">ggeffect()</a></code> and <code><a href="../reference/ggeffect.html">ggemmeans()</a></code> return <em>marginal effects</em>, since the effects are “marginalized” (or “averaged”) over the levels of factors.</p>
<p>There are many different terms: conditional and marginal effects, marginal effects and (estimated) marginal means, effects and predictions, … At this point, it is still not definitely clear which wording to use for <em>ggeffects</em>. Whenever “marginal effects” are mentioned here, it is about model-based predictions at different values of the focal variable(s), holding the non-focal variables constant at their mean, reference level or averaged over factor levels. However, I’m revising the wording in the package documentation and vignettes, to avoid the term “marginal effects” as good as possible…</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Gelman A, Hill J, Vehtari A (2020): “Regression and Other Stories”. Cambridge.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/strengejacke">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
